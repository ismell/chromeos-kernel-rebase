TODO: applied to -rc6 as cb32de1b7e2591f844f18a5513fde8e2bd49bce0
